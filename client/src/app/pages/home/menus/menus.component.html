<!--
<div *ngIf="this.ERROR_MESSAGE!=''" class="text-danger">{{ERROR_MESSAGE}}</div>
-->


<nav class="navbar bg-body-tertiary bg-light">
  <div class="container-fluid text-right justify-content-start">
    <h1 class="navbar-brand user-select-none">Menus</h1>


    <app-add-something-new class="" (close)="resetAllData()" (save)="registerCategory()"
      [data]="register_category_modal_data">
      <div class="input-group mb-3">
        <input type="text" class="form-control" [(ngModel)]="tmpCategory.name" placeholder="Category name">
        <div class="input-group-append">
          <button (click)="tmpCategory.name=''" class="btn btn-outline-danger" type="button">Clear</button>
        </div>
      </div>


      <div class="row">
        <mat-form-field>
          <mat-label>Receivable Employee Groups</mat-label>
          <mat-select [formControl]="tmpRecievableEmployeeGroupIds" multiple>
            @for (a of vars.getEmployeeGroups().values(); track a) {
            <mat-option [value]="a.id">{{a.name}}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>


      <div style="">
        <h3 class="text-secondary text-lg h-3 bg-light" style="">
          Registered Categories
        </h3>
      </div>
      <div class="text-info" *ngIf="tmpCategory.name != ''">Filtered Result</div>
      <div style="position:relative;overflow-x:scroll;min-height:2in;max-height:2in;">
        <table class="table" id="table_Table">
          <thead>
            <tr>
              <th scope="col">Category name</th>
              <th scope="col" style="width:30px"></th>
              <th scope="col" style="width:30px"></th>
            </tr>
          </thead>
          <tbody>
            @for(category of filterCategory();track category){
            <tr>
              <th cope="row">{{category.name}}</th>
              <td><button (click)="editCategory()" class="btn btn-primary">Edit </button></td>
              <td><button (click)="deleteCategory(category.id,category.name)" class="btn btn-danger"> Delete</button>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>


    </app-add-something-new>

    <app-add-something-new class="" (close)="resetAllData()" (save)="registerMenuSize()"
      [data]="register_menuSize_modal_data">
      <div class="input-group mb-3">
        <input type="text" class="form-control" [(ngModel)]="tmpMenuSize.name" placeholder="Menu size">
        <div class="input-group-append">
          <button (click)="tmpMenuSize.name=''" class="btn btn-outline-danger" type="button">Clear</button>
        </div>
      </div>
      <div class="mb-3">
        <label for="select_menu_category">Select Category</label>
        <select [(ngModel)]="tmpMenuSize.category" class="form-select form-select-md mb-2" id="select_menu_category">
          @for(category of vars.getMenuCategories().values();track category){
          <option [ngValue]="category">{{category.name}}</option>
          }
        </select>
      </div>
      <div style="">
        <h3 class="text-secondary text-lg h-3 bg-light" style="">
          Registered menu sizes
        </h3>
      </div>
      <div class="text-info" *ngIf="tmpMenuSize.name !=''">Filtered Result</div>
      <div style="position:relative;overflow-x:scroll;min-height:2in;max-height:2in;">
        <table class="table" id="table_Table">
          <thead>
            <tr>
              <th scope="col">Menu size</th>
              <th scope="col" style="width:30px"></th>
              <th scope="col" style="width:30px"></th>
            </tr>
          </thead>
          <tbody>
            @for(menuSize of filterMenuSize();track menuSize){
            <tr>
              <th cope="row">{{menuSize.name}}</th>
              <td><button class="btn btn-primary">Edit </button></td>
              <td><button (click)="deleteMenuSize(menuSize.id)" class="btn btn-danger"> Delete</button>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
    </app-add-something-new>


    <!--
    <app-add-something-new class="col" (close)="resetAllData()" (save)="addMenu()" [data]="add_menu_modal_data">
    -->
    <app-add-something-new class="" (close)="resetAllData()" (save)="register_menu()" [data]="register_menu_modal_data">
      <div class="input-group mb-3">
        <input type="text" class="form-control" [(ngModel)]="tmpMenuTemplate.name" placeholder="Menu name">
        <div class="input-group-append">
          <button (click)="tmpMenuTemplate.name=''" class="btn btn-outline-danger" type="button">Clear</button>
        </div>
      </div>
      <div class="mb-3">
        <label for="select_menu_category">Select Category</label>
        <select [(ngModel)]="tmpMenuTemplate.category" class="form-select form-select-md mb-2"
          id="select_menu_category">
          @for(category of vars.getMenuCategories().values();track category){
          <option [ngValue]="category">{{category.name}}</option>
          }
        </select>
      </div>
      <div style="">
        <h3 class="text-secondary text-lg h-3 bg-light" style="">
          Registered Menus
        </h3>
      </div>
      <div class="text-info" *ngIf="tmpMenuTemplate.name!=''">Filtered Result</div>
      <div style="position:relative;overflow-x:scroll;min-height:2in;max-height:2in;">
        <table class="table" id="table_Table">
          <thead>
            <tr>
              <th scope="col">Menu name</th>
              <th scope="col" style="width:30px"></th>
              <th scope="col" style="width:30px"></th>
            </tr>
          </thead>
          <tbody>
            @for(menuTemplate of filterMenuTemplate();track menuTemplate){
            <tr>
              <th cope="row">{{menuTemplate.name}}</th>
              <td><button (click)="editMenuTemplate()" class="btn btn-primary">Edit </button></td>
              <td><button (click)="deleteMenuTemplate(menuTemplate.id)" class="btn btn-danger"> Delete</button></td>
            </tr>
            }
          </tbody>
        </table>
      </div>
    </app-add-something-new>
    <app-add-something-new class="" (close)="resetAllData()" (save)="addMenu()" [data]="add_menu_modal_data">
      <div class="mb-3">
        <label for="addMenuMenuTemplate">Menu name</label>
        <select [(ngModel)]="tmpMenu.menuTemplate" class="form-select form-select-md mb-2" id="addMenuMenuTemplate">
          @for(menuTemplate of vars.getMenuTemplates();track menuTemplate){
          <option [ngValue]="menuTemplate">{{menuTemplate.name}}</option>
          }
        </select>
      </div>
      <div class="mb-3">
        <label for="menuSize">Size</label>
        <select [(ngModel)]="tmpMenu.menuSize" class="form-select form-select-md mb-2" id="menuSize">
          <option [ngValue]="newMenuSizeObject">--Choose size--</option>
          @for( menuSize of filterMenuSizeAddMenu();track menuSize){
          <option [ngValue]="menuSize">{{menuSize.name}}</option>
          }
        </select>
      </div>
      <div class="mb-3">
        <label for="menuPrice">Price</label>
        <input [(ngModel)]="tmpMenuPrice.price" type="number" class="form-control" id="menuPrice" placeholder="price">
      </div>
    </app-add-something-new>
  </div>
  <div class="container-fluid justify-content-end">
    <div class="mx-2">
      <select placeholder="Category" [(ngModel)]="filterCategory_Name" class="form-select form-select-md mb-2"
        id="select_menu_category">
        <option [ngValue]="newCategory">All category</option>
        @for(category of vars.getMenuCategories().values();track category){
        <option [ngValue]="category">{{category.name}}</option>
        }
      </select>
    </div>
    <div class="">
      <input [(ngModel)]=" filterMenu_Name" class=" form-control ms-auto align-self-right" maxLength='5' type="search"
        placeholder="Search" aria-label="Search">
    </div>
  </div>

</nav>
<!--
      <button class="btn btn-primary me-2" (click)="filterTable_()" type="submit">Search</button>
      -->

<div class="text-info" *ngIf="filterMenu_Name!=''">Filtered Result</div>
<table class="table" id="table_Table">
  <thead>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">Size</th>
      <th scope="col">Price</th>
      <th scope="col" style="width:30px"></th>
      <th scope="col" style="width:30px"></th>
    </tr>
  </thead>
  <tbody>
    @for(menu of filterMenu();track menu;){
    <tr>
      <th cope="row">{{menu.menuTemplate.name}}</th>
      <td>{{menu.menuSize.name}} </td>
      <td>{{menu!.menuPrices[0]!.price }} </td>
      <td><button (click)="editMenu()" class="btn btn-primary">Edit </button></td>
      <td><button (click)="deleteMenu(menu.id)" class="btn btn-danger"> Delete</button></td>
    </tr>
    }
  </tbody>
</table>
